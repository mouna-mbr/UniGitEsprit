<div class="content">
  <div class="breadcrumb">
    <a href="/classes" class="breadcrumb-link">
      <i class="fas fa-graduation-cap"></i>
      Classes
    </a>
    <i class="fas fa-chevron-right breadcrumb-separator"></i>
    <span class="breadcrumb-current">{{ classe?.nom || 'Détails de la Classe' }}</span>
  </div>
  <div class="class-header" *ngIf="classe">
    <div class="class-info">
      <div class="class-icon">
        <i class="fas fa-graduation-cap"></i>
      </div>
      <div class="class-details-info">
        <h1>{{ classe.nom }}</h1>
        <p class="class-level">{{ classe.anneeUniversitaire }} - {{ classe.level }} - {{ classe.optionFormation }}</p>
        <div class="class-meta">
          <span class="meta-item">
            <i class="fas fa-user-graduate"></i>
            <span>{{ (classe.etudiantIds?.length || 0) }} Étudiant(s)</span>
          </span>
          <span class="meta-item">
            <i class="fas fa-chalkboard-teacher"></i>
            <span>{{ (classe.enseignantIds?.length || 0) }} Enseignant(s)</span>
          </span>
        </div>
      </div>
    </div>
    <div class="class-actions">
      <div class="dropdown-container">
        <button class="btn btn-secondary" (click)="toggleMenu(classe.id, $event)">
          <i class="fas fa-ellipsis-h"></i>
          Plus
        </button>
        <div class="dropdown-menu" [class.show]="isMenuOpen(classe.id)">
          <div class="menu-item" (click)="editClass($event)">
            <i class="fas fa-edit"></i>
            <span>Modifier la Classe</span>
          </div>
          <div class="menu-item danger" (click)="deleteClass(classe.id, $event)">
            <i class="fas fa-trash"></i>
            <span>Supprimer la Classe</span>
          </div>
        </div>
      </div>
      <button class="btn btn-outline" (click)="toggleFavorite(classe.id, $event)" [class.active]="classe.favori">
        <i class="fas fa-heart"></i>
      </button>
    </div>
  </div>

  <div class="stats-grid" *ngIf="classe">
    <div class="stat-card">
      <div class="stat-icon students">
        <i class="fas fa-user-graduate"></i>
      </div>
      <div class="stat-content">
        <div class="stat-number">{{ classe.etudiantIds?.length || 0 }}</div>
        <div class="stat-label">Étudiants</div>
        <div class="stat-change positive">+2 ce mois</div>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon teachers">
        <i class="fas fa-chalkboard-teacher"></i>
      </div>
      <div class="stat-content">
        <div class="stat-number">{{ classe.enseignantIds?.length || 0 }}</div>
        <div class="stat-label">Enseignants</div>
        <div class="stat-change neutral">Stable</div>
      </div>
    </div>
  </div>

  <div class="tabs-container">
    <div class="tabs-header">
      <button class="tab-btn" [class.active]="activeTab === 'details'" (click)="setActiveTab('details')">
        <i class="fas fa-info-circle"></i>
        Détails
      </button>
      <button class="tab-btn" [class.active]="activeTab === 'students'" (click)="setActiveTab('students')">
        <i class="fas fa-user-graduate"></i>
        Étudiants
      </button>
      <button class="tab-btn" [class.active]="activeTab === 'teachers'" (click)="setActiveTab('teachers')">
        <i class="fas fa-chalkboard-teacher"></i>
        Enseignants
      </button>
    </div>
    <div class="tab-content" *ngIf="activeTab === 'details' && classe">
      <div class="section-header">
        <div class="section-title">
          <h3>Informations de la Classe</h3>
          <p>Aperçu des détails de la classe</p>
        </div>
      </div>
      <div class="form-section">
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">Nom de la Classe</label>
            <p class="form-value">{{ classe.nom }}</p>
          </div>
          <div class="form-group">
            <label class="form-label">Année Universitaire</label>
            <p class="form-value">{{ classe.anneeUniversitaire }}</p>
          </div>
          <div class="form-group">
            <label class="form-label">Niveau</label>
            <p class="form-value">{{ classe.level }}</p>
          </div>
          <div class="form-group">
            <label class="form-label">Option de Formation</label>
            <p class="form-value">{{ classe.optionFormation }}</p>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-content" *ngIf="activeTab === 'students' && classe">
      <div class="section-header">
        <div class="section-title">
          <h3>Étudiants</h3>
          <p>Liste des étudiants inscrits</p>
        </div>
      </div>
      <div class="members-list">
        <div *ngFor="let studentId of classe.etudiantIds || []" class="member-tag">
          <span>{{ getUserName(studentId) }} (ID: {{ studentId }})</span>
        </div>
        <div *ngIf="!(classe && classe.etudiantIds && classe.etudiantIds.length > 0)" class="empty-members">
          <p>Aucun étudiant inscrit</p>
        </div>
      </div>
    </div>
    <div class="tab-content" *ngIf="activeTab === 'teachers' && classe">
      <div class="section-header">
        <div class="section-title">
          <h3>Enseignants</h3>
          <p>Liste des enseignants assignés</p>
        </div>
      </div>
      <div class="members-list">
        <div *ngFor="let teacherId of classe.enseignantIds || []" class="member-tag">
          <span>{{ getUserName(teacherId) }} (ID: {{ teacherId }})</span>
        </div>
        <div *ngIf="!(classe && classe.enseignantIds && classe.enseignantIds.length > 0)" class="empty-members">
          <p>Aucun enseignant assigné</p>
        </div>
      </div>
    </div>
  </div>

  <div class="empty-state" *ngIf="!classe">
    <div class="empty-icon">
      <i class="fas fa-graduation-cap"></i>
    </div>
    <h3>Classe Non Trouvée</h3>
    <p>La classe demandée n'a pas pu être chargée.</p>
    <button class="btn btn-primary" (click)="goBack()">
      Retour aux Classes
    </button>
  </div>
</div>

